# チケット #007: コメント追加機能

## 概要
過去の日記のマインドマップに対して、後日コメントノードを追加できる機能

## 受け入れ条件
- 既存のノードを右クリックしてコメント追加メニューが表示されること
- コメントには現在の日付が自動的に付与されること
- コメントノードが他のノードと視覚的に区別できること
- コメントもLocalStorageに保存されること

## タスクリスト

### コンテキストメニュー
- [ ] 右クリックメニューコンポーネントの作成
- [ ] 「コメントを追加」オプションの実装
- [ ] メニューの位置調整ロジック
- [ ] 外側クリックでメニューを閉じる処理

### コメント入力
- [ ] コメント入力モーダルの作成
- [ ] 日付自動挿入機能
- [ ] コメント本文入力フィールド
- [ ] 送信・キャンセル処理

### コメントノード
- [ ] コメント用ノードタイプの定義
- [ ] コメントノードのスタイリング（点線枠など）
- [ ] 日付表示の実装
- [ ] アイコン追加（コメントアイコン）

### データ管理
- [ ] コメントデータ構造の定義
- [ ] 既存マインドマップへのコメント追加処理
- [ ] LocalStorage更新処理
- [ ] コメント履歴の管理

### UI/UX
- [ ] コメントノードの配置アルゴリズム
- [ ] コメント追加アニメーション
- [ ] コメント数の表示（ノード上にバッジ）

## 技術的詳細

### コメントノード構造
```typescript
interface CommentNode extends MindMapNode {
  type: 'comment';
  commentDate: Date;     // コメント追加日
  targetNodeId: string;  // コメント対象のノードID
  content: string;       // コメント内容
}
```

### スタイリング
```css
/* コメントノード */
.comment-node {
  border: 2px dashed #9FA8DA;  /* パステルパープルの点線 */
  background: #EDE7F6;          /* 薄いパステルパープル */
}

/* 日付表示 */
.comment-date {
  font-size: 0.8em;
  color: #7E57C2;
}
```

### コンテキストメニュー項目
```typescript
const contextMenuItems = [
  {
    label: 'コメントを追加',
    icon: '💭',
    action: 'addComment'
  },
  // 将来的な拡張用
  {
    label: 'ノードを削除',
    icon: '🗑️',
    action: 'deleteNode',
    disabled: true  // MVPでは無効
  }
];
```

## 依存関係
- チケット#003（マインドマップ表示）が完了していること
- チケット#006（過去の日記閲覧）が完了していること

## 備考
- コメントには文字数制限なし
- コメントからさらに質問生成はしない（MVPでは）
- コメントの編集・削除機能は将来実装